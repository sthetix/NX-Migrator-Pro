2025-11-16 19:50:57,281 [INFO] main: ============================================================
2025-11-16 19:50:57,281 [INFO] main: NX Migrator Pro v1.0.0 - Operation Log
2025-11-16 19:50:57,282 [INFO] main: Log file: nxmigratorpro_16112025_195057.log
2025-11-16 19:50:57,282 [INFO] main: ============================================================
2025-11-16 19:50:57,282 [INFO] gui.main_window: Migration operation started - logging to nxmigratorpro_16112025_195057.log
2025-11-16 19:50:57,289 [INFO] core.disk_manager: Cleaning disk \\.\PhysicalDrive4 (deleting all partitions)...
2025-11-16 19:50:57,289 [DEBUG] core.disk_manager: Disk index: 4
2025-11-16 19:50:57,316 [INFO] core.disk_manager: Running diskpart clean command...
2025-11-16 19:51:00,564 [INFO] core.disk_manager: Successfully cleaned disk with diskpart
2025-11-16 19:51:00,564 [INFO] core.disk_manager: All partitions have been deleted
2025-11-16 19:51:00,565 [INFO] core.disk_manager: Waiting for Windows to update partition cache...
2025-11-16 19:51:02,568 [INFO] core.migration_engine: Waiting 3 seconds for Windows to release disk after clean...
2025-11-16 19:51:05,570 [INFO] core.migration_engine: Performing additional disk refresh after clean...
2025-11-16 19:51:05,570 [INFO] core.disk_manager: Preparing disk \\.\PhysicalDrive4 for write operations...
2025-11-16 19:51:05,573 [DEBUG] core.disk_manager: Disk index: 4
2025-11-16 19:51:05,573 [INFO] core.disk_manager: Attempting to refresh disk using diskpart...
2025-11-16 19:51:09,922 [INFO] core.disk_manager: Successfully refreshed disk with diskpart
2025-11-16 19:51:10,424 [DEBUG] core.disk_manager: Could not enumerate partitions (WMI cache may be stale after disk operations): x_wmi
2025-11-16 19:51:10,425 [DEBUG] core.disk_manager: Checking disk write protection status...
2025-11-16 19:51:10,716 [INFO] core.disk_manager: Disk is writable (no write protection detected)
2025-11-16 19:51:10,718 [DEBUG] core.disk_manager: Successfully sent IOCTL_DISK_UPDATE_PROPERTIES
2025-11-16 19:51:10,719 [INFO] core.disk_manager: Disk preparation complete
2025-11-16 19:51:11,728 [INFO] core.disk_manager: Preparing disk \\.\PhysicalDrive4 for write operations...
2025-11-16 19:51:11,729 [DEBUG] core.disk_manager: Disk index: 4
2025-11-16 19:51:11,729 [INFO] core.disk_manager: Attempting to refresh disk using diskpart...
2025-11-16 19:51:16,176 [INFO] core.disk_manager: Successfully refreshed disk with diskpart
2025-11-16 19:51:16,677 [DEBUG] core.disk_manager: Could not enumerate partitions (WMI cache may be stale after disk operations): x_wmi
2025-11-16 19:51:16,677 [DEBUG] core.disk_manager: Checking disk write protection status...
2025-11-16 19:51:16,692 [INFO] core.disk_manager: Disk is writable (no write protection detected)
2025-11-16 19:51:16,693 [DEBUG] core.disk_manager: Successfully sent IOCTL_DISK_UPDATE_PROPERTIES
2025-11-16 19:51:16,694 [INFO] core.disk_manager: Disk preparation complete
2025-11-16 19:51:16,714 [DEBUG] core.disk_manager: write_sectors: disk=\\.\PhysicalDrive4, start=0, size=16777216 bytes
2025-11-16 19:51:16,715 [DEBUG] core.disk_manager: Opening disk \\.\PhysicalDrive4 for writing...
2025-11-16 19:51:16,718 [DEBUG] core.disk_manager: Trying to open with mode: exclusive + no buffering
2025-11-16 19:51:16,733 [DEBUG] core.disk_manager: Successfully opened disk handle: <PyHANDLE:1376> with mode: exclusive + no buffering
2025-11-16 19:51:16,733 [DEBUG] core.disk_manager: Seeking to offset 0 (sector 0)...
2025-11-16 19:51:16,734 [DEBUG] core.disk_manager: Seek successful, new position: 0
2025-11-16 19:51:16,737 [DEBUG] core.disk_manager: Writing 16777216 bytes...
2025-11-16 19:51:17,146 [DEBUG] core.disk_manager: Write completed: error_code=0, bytes_written=16777216
2025-11-16 19:51:17,146 [DEBUG] core.disk_manager: Flushed file buffers
2025-11-16 19:51:17,152 [DEBUG] core.disk_manager: Closed disk handle
2025-11-16 19:51:17,152 [DEBUG] core.disk_manager: Successfully wrote 16777216 bytes to sector 0
2025-11-16 19:51:17,165 [INFO] core.disk_manager: Preparing disk \\.\PhysicalDrive4 for write operations...
2025-11-16 19:51:17,165 [DEBUG] core.disk_manager: Disk index: 4
2025-11-16 19:51:17,166 [INFO] core.disk_manager: Attempting to refresh disk using diskpart...
2025-11-16 19:51:20,839 [INFO] core.disk_manager: Successfully refreshed disk with diskpart
2025-11-16 19:51:21,340 [DEBUG] core.disk_manager: Could not enumerate partitions (WMI cache may be stale after disk operations): x_wmi
2025-11-16 19:51:21,340 [DEBUG] core.disk_manager: Checking disk write protection status...
2025-11-16 19:51:21,355 [INFO] core.disk_manager: Disk is writable (no write protection detected)
2025-11-16 19:51:21,358 [DEBUG] core.disk_manager: Successfully sent IOCTL_DISK_UPDATE_PROPERTIES
2025-11-16 19:51:21,360 [INFO] core.disk_manager: Disk preparation complete
2025-11-16 19:51:21,363 [INFO] core.partition_writer: === Creating MBR partition table ===
2025-11-16 19:51:21,367 [INFO] core.partition_writer: Found 2 partitions marked for MBR (in_mbr=True)
2025-11-16 19:51:21,367 [INFO] core.partition_writer:   - hos_data (FAT32): type=0x0C, sector=32768, size=972283MB
2025-11-16 19:51:21,368 [INFO] core.partition_writer:   - emummc1 (emuMMC): type=0xE0, sector=1991278592, size=4127MB
2025-11-16 19:51:21,368 [INFO] core.partition_writer: MBR slot 0: hos_data (FAT32) - type=0x0C, start=32768, size=1991235584 sectors
2025-11-16 19:51:21,369 [INFO] core.partition_writer: MBR slot 1: emummc1 (emuMMC) - type=0xE0, start=1991278592, size=8452096 sectors
2025-11-16 19:51:21,369 [INFO] core.partition_writer: MBR creation complete: 2 total slots used
2025-11-16 19:51:21,370 [DEBUG] core.disk_manager: write_sectors: disk=\\.\PhysicalDrive4, start=0, size=512 bytes
2025-11-16 19:51:21,375 [DEBUG] core.disk_manager: Opening disk \\.\PhysicalDrive4 for writing...
2025-11-16 19:51:21,376 [DEBUG] core.disk_manager: Trying to open with mode: exclusive + no buffering
2025-11-16 19:51:21,393 [DEBUG] core.disk_manager: Successfully opened disk handle: <PyHANDLE:1388> with mode: exclusive + no buffering
2025-11-16 19:51:21,393 [DEBUG] core.disk_manager: Seeking to offset 0 (sector 0)...
2025-11-16 19:51:21,394 [DEBUG] core.disk_manager: Seek successful, new position: 0
2025-11-16 19:51:21,397 [DEBUG] core.disk_manager: Writing 512 bytes...
2025-11-16 19:51:21,399 [DEBUG] core.disk_manager: Write completed: error_code=0, bytes_written=512
2025-11-16 19:51:21,401 [DEBUG] core.disk_manager: Flushed file buffers
2025-11-16 19:51:21,409 [DEBUG] core.disk_manager: Closed disk handle
2025-11-16 19:51:21,409 [DEBUG] core.disk_manager: Successfully wrote 512 bytes to sector 0
2025-11-16 19:51:21,409 [INFO] core.migration_engine: Refreshing disk to make partitions visible...
2025-11-16 19:51:26,960 [INFO] core.migration_engine: Disk partitions refreshed
2025-11-16 19:51:28,962 [INFO] core.migration_engine: Waiting for Windows to recognize new partitions...
2025-11-16 19:51:31,963 [INFO] core.migration_engine: Refreshing disk before formatting...
2025-11-16 19:51:36,447 [INFO] core.migration_engine: Disk partitions refreshed
2025-11-16 19:51:38,447 [INFO] core.migration_engine: Formatting FAT32 partition with fat32format.exe...
2025-11-16 19:51:38,448 [INFO] core.migration_engine: Creating FAT32 filesystem using fat32format.exe...
2025-11-16 19:51:38,448 [INFO] core.migration_engine: FAT32 format tool: D:\Coding\NXMigratorPro\tool\fat32format.exe
2025-11-16 19:51:38,451 [INFO] core.migration_engine: Partition size: 949.50 GB
2025-11-16 19:51:38,451 [INFO] core.migration_engine: Cluster size: 128 sectors (64KB)
2025-11-16 19:51:38,452 [INFO] core.migration_engine: Assigning and locking drive letter for FAT32 partition...
2025-11-16 19:51:38,452 [INFO] core.migration_engine: Looking for partition at sector 32768 (attempt 1/10)...
2025-11-16 19:51:38,456 [WARNING] core.migration_engine: Error finding partition: <x_wmi: Unexpected COM Error (-2147352567, 'Exception occurred.', (0, 'SWbemServicesEx', 'The application called an interface that was marshalled for a different thread. ', None, 0, -2147417842), None)>
2025-11-16 19:51:40,460 [INFO] core.migration_engine: Looking for partition at sector 32768 (attempt 2/10)...
2025-11-16 19:51:40,547 [INFO] core.migration_engine: Found 2 partitions on disk 4
2025-11-16 19:51:40,549 [INFO] core.migration_engine:   Partition 0: starts at sector 32768
2025-11-16 19:51:40,551 [INFO] core.migration_engine: Found matching partition number: 0
2025-11-16 19:51:40,551 [INFO] core.migration_engine: Ensuring partition 0 has a drive letter...
